<!DOCTYPE html><html><head hexo-theme="https://volantis.js.org/#1.7.1"><meta charset="utf-8"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="HandheldFriendly" content="True"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>CSP 2019 集训 数学 - Sweetlemon 的异世界</title><meta name="keywords" content="笔记,数学"><meta name="description" content="数学"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css"><link rel="shortcut icon" type="image/x-icon" href="https://cdn.jsdelivr.net/gh/mrj1018/OI/lemon.png"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@1.7.1/css/style.css"><script>function setLoadingBarProgress(e){document.getElementById("loading-bar").style.width=e+"%"}</script></head><body><div class="cover-wrapper"><cover class="cover post half"><p class="title">Sweetlemon 的异世界</p><p class="subtitle">原来你也在这里啊</p><div class="m_search"><form name="searchform" class="form u-search-form"><i class="icon fas fa-search fa-fw"></i> <input type="text" class="input u-search-input" placeholder="一直在寻找着你的踪迹"></form></div><div class="menu navigation"><ul class="h-list"><li><a class="nav home" href="/" id="home"><i class="fas fa-home fa-fw"></i>&nbsp;主页</a></li><li><a class="nav home" href="/categories/" id="categories"><i class="fas fa-folder-open fa-fw"></i>&nbsp;分类</a></li><li><a class="nav home" href="/archives/" id="archives"><i class="fas fa-archive fa-fw"></i>&nbsp;归档</a></li><li><a class="nav home" href="/about/" id="about"><i class="fas fa-info-circle fa-fw"></i>&nbsp;关于</a></li></ul></div></cover><header class="l_header nav-blur"><div id="loading-bar-wrapper"><div id="loading-bar"></div></div><div class="wrapper"><div class="nav-main container container--flex"><a class="logo flat-box" target="_self" href="/">Sweetlemon 的异世界</a><div class="menu navigation"><ul class="h-list"><li><a class="nav flat-box" href="/" id="home"><i class="fas fa-home fa-fw"></i>&nbsp;主页</a></li><li><a class="nav flat-box" href="/categories/" id="categories"><i class="fas fa-folder-open fa-fw"></i>&nbsp;分类</a></li><li><a class="nav flat-box" href="/archives/" id="archives"><i class="fas fa-archive fa-fw"></i>&nbsp;归档</a></li><li><a class="nav flat-box" href="/about/" id="about"><i class="fas fa-info-circle fa-fw"></i>&nbsp;关于</a></li></ul></div><div class="m_search"><form name="searchform" class="form u-search-form"><i class="icon fas fa-search fa-fw"></i> <input type="text" class="input u-search-input" placeholder="一直在寻找着你"></form></div><ul class="switcher h-list"><li class="s-search"><a class="fas fa-search fa-fw" target="_self" href="javascript:void(0)"></a></li><li class="s-menu"><a class="fas fa-bars fa-fw" target="_self" href="javascript:void(0)"></a></li></ul></div><div class="nav-sub container container--flex"><a class="logo flat-box"></a><ul class="switcher h-list"><li class="s-comment"><a class="flat-btn fas fa-comments fa-fw" target="_self" href="javascript:void(0)"></a></li><li class="s-toc"><a class="flat-btn fas fa-list fa-fw" target="_self" href="javascript:void(0)"></a></li></ul></div></div></header><aside class="menu-phone white-box"><header><nav class="menu navigation"><ul><li><a class="nav flat-box" href="/" id="home"><i class="fas fa-home fa-fw"></i>&nbsp;主页</a></li><li><a class="nav flat-box" href="/categories/" id="categories"><i class="fas fa-folder-open fa-fw"></i>&nbsp;分类</a></li><li><a class="nav flat-box" href="/archives/" id="archives"><i class="fas fa-archive fa-fw"></i>&nbsp;归档</a></li><li><a class="nav flat-box" href="/about/" id="about"><i class="fas fa-info-circle fa-fw"></i>&nbsp;关于</a></li></ul></nav></header></aside><script>setLoadingBarProgress(40)</script></div><div class="l_body"><div class="body-wrapper"><div class="l_main"><article id="post" class="post white-box article-type-post" itemscope itemprop="blogPost"><section class="meta"><div class="meta" id="header-meta"><h1 class="title"><a href="/CSP2019-math/">CSP 2019 集训 数学</a></h1><div class="new-meta-box"><div class="new-meta-item author"><a href="https://sweetlemon39.github.io/" rel="nofollow"><img src="https://cdn.jsdelivr.net/gh/mrj1018/OI/lemon.png"><p>Sweetlemon</p></a></div><div class="new-meta-item category"><a href="/categories/%E5%8D%B3%E6%97%B6%E7%AC%94%E8%AE%B0/" rel="nofollow"><i class="fas fa-folder-open" aria-hidden="true"></i><p>即时笔记</p></a></div><div class="new-meta-item date"><a class="notlink"><i class="fas fa-edit" aria-hidden="true"></i><p>发布于：2019年11月14日</p></a></div><div class="new-meta-item date" itemprop="dateUpdated" datetime="2019-11-14T00:00:00+00:00"><a class="notlink"><i class="fas fa-save" aria-hidden="true"></i><p>更新于：2019年11月14日</p></a></div></div><hr></div></section><section class="article typo"><div class="article-entry" itemprop="articleBody"><h2 id="数学"><a href="#数学" class="headerlink" title="数学"></a>数学</h2><a id="more"></a><h3 id="gcd"><a href="#gcd" class="headerlink" title="$\gcd$"></a>$\gcd$</h3><h4 id="定义与证明"><a href="#定义与证明" class="headerlink" title="定义与证明"></a>定义与证明</h4><p>定义：$\gcd(a,b)$ 定义为最大的 $d$，使得 $d\mid a,d\mid b$。</p><p>$\gcd(a,b)=\gcd ( b,a % b )$ 的证明：设 $a=bq+r$。</p><p>假设 $d\mid b$，则可以由上式证明 $d\mid a$ 等价于 $d\mid r$。证毕。</p><h4 id="CQOI-2014-数三角形"><a href="#CQOI-2014-数三角形" class="headerlink" title="CQOI 2014 数三角形"></a>CQOI 2014 数三角形</h4><p>用（简单）容斥原理，用三点组的个数减三点共线情况的个数。</p><p>如何计算三点共线情况的个数呢？</p><p>回忆这个定理：</p><blockquote><p>定理 $2.33$ 设 $A(0,0),B(n,m)(n,m\in \mathbb{N}_{+})$，那么线段 $AB$ 上整点的个数即为$\gcd(n,m)+1$。（——能量采集）</p></blockquote><p>只要暴力找出所有直线即可。</p><h3 id="mathrm-exgcd"><a href="#mathrm-exgcd" class="headerlink" title="$\mathrm{exgcd}$"></a>$\mathrm{exgcd}$</h3><h4 id="算法证明"><a href="#算法证明" class="headerlink" title="算法证明"></a>算法证明</h4><p>根据数论基础知识，$ax+by=\gcd(a,b)$（$a,b$ 是给定正整数，$x,y\in Z$）有无数组解。</p><p>并且，如果我们可以在欧几里得算法的过程中维护这个方程的解，那么就能在计算出 $\gcd$ 的同时把解也算出来。</p><p>首先，当 $b=0$ 时，这个方程的解就是 $(x,y)=(1,0)$。</p><p>接着，假设 $a=bq+r$，设 $bx’+ry’=g$，我们需要找出一组使得 $ax+by=g$ 的 $(x,y)$。</p><p>把 $a=bq+r$ 代入上面的式子得 $bqx+rx+by=g$，也就是 $b(qx+y)+rx=g$。把这个式子与 $bx’+ry’=g$ 比对即得 $qx+y=x’,x=y’$，也就是 $(x,y)=(y’,x’-qy’)$。</p><h4 id="青蛙的约会"><a href="#青蛙的约会" class="headerlink" title="青蛙的约会"></a>青蛙的约会</h4><p>随便推一下式子就可以得到 $t(n-m)+sL=x-y$，其中只有 $s,t$ 是整未知数。先把两边都除以 $\gcd(n-m,L)$，标准化之后用 $\mathrm{exgcd}$ 求解就行了。</p><h4 id="小凯的遗憾-疑惑"><a href="#小凯的遗憾-疑惑" class="headerlink" title="小凯的遗憾 疑惑"></a>小凯的<del>遗憾</del> 疑惑</h4><p>证明起来似乎挺长的，还是要注重打表找规律。</p><h3 id="快速幂-mathrm-kasumi-与费马-欧拉定理"><a href="#快速幂-mathrm-kasumi-与费马-欧拉定理" class="headerlink" title="快速幂 ($\mathrm{kasumi}$) 与费马-欧拉定理"></a>快速幂 ($\mathrm{kasumi}$) 与费马-欧拉定理</h3><h4 id="费马小定理"><a href="#费马小定理" class="headerlink" title="费马小定理"></a>费马小定理</h4><p>费马小定理：$p$ 是质数，那么 $\forall a\in [1,p),a^{p-1}\equiv 1\pmod{p}$。</p><p>当然可以用“元素的阶整除群的阶”证明。</p><p>这里提供一个使用二项式定理的证明方法。</p><p>$(a+1)^p=a^p+\mathrm{C}^1_pa^{p-1}+\mathrm{C}^2_pa^{p-2}+\cdots+\mathrm{C}^{p-1}_pa+1$。</p><p>由于 $p$ 是质数，因此 $\mathrm{C}^1_p,\mathrm{C}^2_p,\cdots,\mathrm{C}^{p-1}_{p}$ 的分母都没有 $p$ 因子，分子有 $p$ 因子，因此这些数都是 $p$ 的倍数。</p><p>因此 $(a+1)^p\equiv a^p+1$，从 $0^p\equiv 0$ 即可归纳出 $a^p\equiv a$。移项得 $a(a^{p-1}-1)\equiv 0$。由于 $a\in [1,p)$，因此两边除以 $a$（乘以 $a$ 的逆元）即得 $a^{p-1}\equiv 1$。</p><h4 id="逆元"><a href="#逆元" class="headerlink" title="逆元"></a>逆元</h4><p>如何求逆元呢？可以用 $\mathrm{kasumi}$ 配合费马-欧拉定理，也可以用扩展欧几里得。</p><p>这里提供两种 $O(n)$ 线性推逆元的方法。</p><p>第一种是经典方法。设 $p=aq+r\ (0&lt;r&lt;a)$，那么 $aq\equiv -r$，$a^{-1}\equiv -qr^{-1}$。这种方法仅适用于 $p$ 是质数的情况。</p><p>第二种利用了阶乘。我们可以在 $O(n)$ 时间内计算出 $1!,2!,\cdots,n!$。接着我们用某一种方法计算出 $(n!)^{-1}$，并递推 $((n-1)!)^{-1}\equiv n\times (n!)^{-1}$。于是 $x^{-1}\equiv (x-1)!\times (x!)^{-1}$。这个方法也许比经典方法快，而且适用于 $p$ 不是质数的情况（但是 $n$ 必须小于 $p$ 的最小质因子）。而且由 $(n!)^{-1}$ 递推 $((n-1)!)^{-1}$ 的方法也可以用于分段打表计算阶乘的逆元。</p><h4 id="计算系数-组合数问题"><a href="#计算系数-组合数问题" class="headerlink" title="计算系数 组合数问题"></a>计算系数 组合数问题</h4><p>这两道题都涉及 $\mathrm{C}$ 的计算。可以灵活地运用定义式和杨辉三角递推式，在合适的场景使用合适的式子简化计算。也就是，如果 $n$ 只有 $2000$，那么使用杨辉三角就足够了。</p><h3 id="中国剩余定理"><a href="#中国剩余定理" class="headerlink" title="中国剩余定理"></a>中国剩余定理</h3><p>如果 $p_1,p_2,\cdots,p_n$ 互质，那么下面方程组</p><p>$$\begin{cases}x \equiv a_1\pmod{p_1}\\ x\equiv a_2\pmod{p_2}\\ x\equiv a_3\pmod{p_3}\\ \vdots\\ x \equiv a_n \pmod{p_n}\end{cases}$$</p><p>在 $\mod{p_1 p_2 \cdots p_n}$ 意义下有唯一解。</p><p>如何求这一组解呢？</p><p>这里有一个神奇构造。</p><p>令 $M=\Pi p$，则 $M_i=\Pi^{i-1}<em>{j=1} p_j \times \Pi^{n}</em>{j=i+1} p_j$，于是 $t_i$ 是 $M_i$ 在 $\mod{p_i}$ 意义下的逆元。那么令 $x=\sum_{i=1}^n a_iM_it_i$ 即可。</p><p>如果考场上不记得神奇构造了，那就可以用 $\mathrm{exCRT}$。</p><p>主要应用还是合并同余方程。</p><h3 id="各种筛"><a href="#各种筛" class="headerlink" title="各种筛"></a>各种筛</h3><h4 id="Violet-5-樱花"><a href="#Violet-5-樱花" class="headerlink" title="Violet 5 樱花"></a>Violet 5 樱花</h4><p>求不定方程 $\frac{1}{x}+\frac{1}{y}=\frac{1}{n!}$ 的正整数解数量。</p><p>令 $m=n!$。由于每一个 $x$ 唯一对应一个 $y$，因此我们可以把 $y$ 用 $x$ 表示，得到 $y=\frac{xm}{x-m}$。接着用分母换元法，令 $x-m=t$，$y=\frac{(m+t)m}{t}=\frac{m^2}{t}+m$。于是 $y$ 为整数的充要条件为 $t\mid m^2$。</p><p>同时，对 $m^2$ 的每一个因子 $t$，都可以唯一确定一组 $(x,y)$。因此只需要求 $m^2$ 的因子数，这只需要把 $n!$ 质因数分解就可以了。</p><p>因此对于这样的题目，进行必要的数论变换是非常重要的。</p><h3 id="高精度"><a href="#高精度" class="headerlink" title="高精度"></a>高精度</h3><p>不要写错。</p><h4 id="LLH邀请赛-大数计算器"><a href="#LLH邀请赛-大数计算器" class="headerlink" title="LLH邀请赛 大数计算器"></a>LLH邀请赛 大数计算器</h4><p>求 $\mathrm{C}^r_n$ 的前 $3$ 位和去除所有末尾 $0$ 后的后 $9$ 位。</p><p>后 $9$ 位相当于模 $10^9$，直接用 泳装 一题的方法，把因子 $2$ 和因子 $5$ 分开处理即可。</p><p>前 $3$ 位怎么做呢？<code>long double</code> 信仰过？</p><p>太大了，连 <code>long double</code> 都会爆啊。</p><p>取一个 $\ln$ 然后相加减，最后 $\exp$ 吧。在对精度要求不高的时候，取对数也是不错的方法。</p><h4 id="解方程"><a href="#解方程" class="headerlink" title="解方程"></a>解方程</h4><p>枚举是不是解的时候在模意义下进行，判断是不是真的解的时候用高精。</p><p>当然也可以凭信仰，选取几个模数，把所有系数也取模，在这几个模意义下都进行运算，如果都满足方程就“认为”这个数真的是解了。</p><h3 id="容斥原理（经典型）"><a href="#容斥原理（经典型）" class="headerlink" title="容斥原理（经典型）"></a>容斥原理（经典型）</h3><h4 id="Cirno-的完美算数教室"><a href="#Cirno-的完美算数教室" class="headerlink" title="Cirno 的完美算数教室"></a>Cirno 的完美算数教室</h4><p>暴力容斥，暴力出奇迹，记得加剪枝。</p><h4 id="HAOI-2008-硬币购物"><a href="#HAOI-2008-硬币购物" class="headerlink" title="HAOI 2008 硬币购物"></a>HAOI 2008 硬币购物</h4><p>这个背包很有特点，物品种类很少，但是背包容量和物品数量很大，肯定不能 $\mathrm{dp}$ 或搜索。那么我们就用数学方法。</p><p>设第 $i$ 种硬币用了 $x_i$ 枚，那么 $c_1x_1+c_2x_2+c_3x_3+c_4x_4=s$，限制是 $0\le x_i\le d_i$。</p><p>假如没有限制，那么这题就是一个简单的隔板法，把定义域下界上调到 $1$ 就行了。</p><p>那么现在有了限制，就计算出各种“不符合限制”的情况，用容斥原理计算就行了。</p><p>具体地，用“总方案数”减去“至少某一种硬币不符合限制”的方案数，加上“至少某两种硬币不符合限制”的方案数，减去“至少某三种硬币不符合限制”的方案数，最后加上“四种硬币都不符合限制”的情况。</p><h3 id="博弈论"><a href="#博弈论" class="headerlink" title="博弈论"></a>博弈论</h3><h4 id="取石子游戏-1-——理解必胜和必败态"><a href="#取石子游戏-1-——理解必胜和必败态" class="headerlink" title="取石子游戏 1 ——理解必胜和必败态"></a>取石子游戏 1 ——理解必胜和必败态</h4><p>只有一堆石子，每次拿 $[1,k]$ 个，不能拿的输。</p><p>画状态图可以发现 $0,k+1,2(k+1),\cdots$ 都是先手必败，其余都是先手必胜。接下来归纳证明即可。</p><h4 id="取石子游戏-2-——组合游戏和-SG-函数"><a href="#取石子游戏-2-——组合游戏和-SG-函数" class="headerlink" title="取石子游戏 2 ——组合游戏和 SG 函数"></a>取石子游戏 2 ——组合游戏和 SG 函数</h4><p>有 $n$ 堆石子，每次可以在一堆石子中拿任意多个，不能拿的输。</p><p>这个东西不用 SG 做实在不太行啊。</p><p>关于组合游戏和 SG 函数、SG 定理的理解，详见在学军的笔记。</p><p>Nim 是经典模型，$\mathrm{SG}(x)=x$。</p><p>如果针对 Nim 游戏，那么可以比较简单地对“异或方法”的可行性进行证明。</p><p>取异或值的最高位。由于这一位是最高位，因此一定存在一堆石子，它的石子数这一位为 $1$。令这一堆留下来的石子数恰好使得异或值为 $0$，那么留下来的石子数在那一位是 $0$，于是留下的石子数少于原来的石子数，也就是这种取的方案是一定可行的。</p><p>这样异或值非零一定能转移到异或值为零的状态。而异或值为零的状态只能转为异或值非零的状态，且终态异或值为零。于是证毕。</p><h4 id="取石子游戏-3-——游戏-1-和游戏-2-的结合"><a href="#取石子游戏-3-——游戏-1-和游戏-2-的结合" class="headerlink" title="取石子游戏 3 ——游戏 1 和游戏 2 的结合"></a>取石子游戏 3 ——游戏 1 和游戏 2 的结合</h4><p>有 $n$ 堆石子，每次可以在 $[1,k]$ 堆石子中拿任意多个，不能拿的输。</p><p>考虑 $k=1$，那么就是游戏 2；若 $a_i=1$，那么就是游戏 1。因此这一个游戏是这两个游戏的结合。</p><p>又来一个神奇操作。把每一堆都用二进制表示，计算每一个二进制位</p></div><section class="meta" id="footer-meta"><div class="new-meta-box"><div class="new-meta-item meta-tags"><a class="tag" href="/tags/%E7%AC%94%E8%AE%B0/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i>&nbsp;<p>笔记</p></a></div><div class="new-meta-item meta-tags"><a class="tag" href="/tags/%E6%95%B0%E5%AD%A6/" rel="nofollow"><i class="fas fa-tag" aria-hidden="true"></i>&nbsp;<p>数学</p></a></div></div></section><div class="prev-next"><section class="prev"><span class="art-item-left"><h4><a href="/THUWC-2020/" rel="prev" title="THUWC 2020 游记"><i class="fas fa-chevron-left" aria-hidden="true"></i> THUWC 2020 游记</a></h4><h6 class="tags">&nbsp;<a class="tag" href="/tags/THUWC/"><i class="fas fa-tag" aria-hidden="true"></i> THUWC</a></h6></span></section><section class="next"><span class="art-item-right" aria-hidden="true"><h4><a href="/CSP2019-search-and-ds/" rel="prev" title="CSP 2019 集训 搜索和数据结构">CSP 2019 集训 搜索和数据结构 <i class="fas fa-chevron-right" aria-hidden="true"></i></a></h4><h6 class="tags"><a class="tag" href="/tags/%E7%AC%94%E8%AE%B0/"><i class="fas fa-tag" aria-hidden="true"></i> 笔记</a> <a class="tag" href="/tags/%E6%90%9C%E7%B4%A2/"><i class="fas fa-tag" aria-hidden="true"></i> 搜索</a> <a class="tag" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"><i class="fas fa-tag" aria-hidden="true"></i> 数据结构</a>&nbsp;</h6></span></section></div></section></article><article class="post white-box comments"><section class="article typo"><h4><i class="fas fa-comments fa-fw" aria-hidden="true"></i>&nbsp;评论</h4><section id="comments"><div id="valine_container" class="valine_thread"><i class="fas fa-spinner fa-spin fa-fw"></i></div></section></section></article><script type="text/x-mathjax-config">MathJax.Hub.Config({
    "HTML-CSS": {
      preferredFont: "TeX",
      availableFonts: ["STIX","TeX"],
      linebreaks: { automatic:true },
      EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
      inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
      processEscapes: true,
      ignoreClass: "tex2jax_ignore|dno",
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: { autoNumber: "AMS" },
      noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
      Macros: { href: "{}" }
    },
    messageStyle: "none"
  });</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += (all[i].SourceElement().parentNode.className ? ' ' : '') + 'has-jax';
    }
  });</script><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>window.subData={title:"CSP 2019 集训 数学",tools:!0}</script></div><aside class="l_side"><section class="widget blogger widget-blur desktop"><div class="content"><div class="avatar"><img class="avatar" src="https://cdn.jsdelivr.net/gh/mrj1018/OI/lemon.png"></div><div class="text"><h2>Sweetlemon</h2><p>一枚有趣的 OIer！</p></div><div class="social-wrapper"><a href="mailto:mrj1018@163.com" class="social fas fa-envelope flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a> <a href="https://github.com/mrj1018" class="social fab fa-github flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a> <a href="https://www.luogu.com.cn/user/25008" class="social fas fa-code flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a></div></div></section><section class="widget grid widget-blur desktop mobile"><header><i class="fas fa-map-signs fa-fw" aria-hidden="true"></i><span class="name">博客导航</span></header><div class="content"><ul class="grid navigation"><li><a class="flat-box" title="/" href="/" id="home"><i class="fas fa-home fa-fw" aria-hidden="true"></i> 博客主页</a></li><li><a class="flat-box" title="/categories/" href="/categories/" id="categories"><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i> 文章分类</a></li><li><a class="flat-box" title="/archives/" href="/archives/" id="archives"><i class="fas fa-archive fa-fw" aria-hidden="true"></i> 文章归档</a></li><li><a class="flat-box" title="/friends/" href="/friends/" id="friends"><i class="fas fa-users fa-fw" aria-hidden="true"></i> 博客友链</a></li><li><a class="flat-box" title="/comments/" href="/comments/" id="comments"><i class="fas fa-comments fa-fw" aria-hidden="true"></i> 留言评论</a></li><li><a class="flat-box" title="/about/" href="/about/" id="about"><i class="fas fa-info-circle fa-fw" aria-hidden="true"></i> 关于博主</a></li></ul></div></section><section class="widget grid widget-blur desktop mobile"><header><a href="/useful-links/"><i class="fas fa-link fa-fw" aria-hidden="true"></i><span class="name">常用站导航</span></a></header><div class="content"><ul class="grid navigation"><li><a class="flat-box" title="https://oi-wiki.org/" href="https://oi-wiki.org/" rel="external nofollow noopener noreferrer" target="_blank" id="https:oi-wiki.org"><i class="fab fa-wikipedia-w fa-fw" aria-hidden="true"></i> OI Wiki</a></li><li><a class="flat-box" title="https://www.luogu.com.cn/" href="https://www.luogu.com.cn/" rel="external nofollow noopener noreferrer" target="_blank" id="https:www.luogu.com.cn"><i class="fas fa-code fa-fw" aria-hidden="true"></i> 洛谷</a></li><li><a class="flat-box" title="https://www.codeforces.com/" href="https://www.codeforces.com/" rel="external nofollow noopener noreferrer" target="_blank" id="https:www.codeforces.com"><i class="fas fa-code fa-fw" aria-hidden="true"></i> Codeforces</a></li><li><a class="flat-box" title="http://uoj.ac/" href="http://uoj.ac/" rel="external nofollow noopener noreferrer" target="_blank" id="http:uoj.ac"><i class="fas fa-code fa-fw" aria-hidden="true"></i> UOJ</a></li><li><a class="flat-box" title="https://loj.ac/" href="https://loj.ac/" rel="external nofollow noopener noreferrer" target="_blank" id="https:loj.ac"><i class="fas fa-code fa-fw" aria-hidden="true"></i> LOJ</a></li><li><a class="flat-box" title="http://www.noi.cn/" href="http://www.noi.cn/" rel="external nofollow noopener noreferrer" target="_blank" id="http:www.noi.cn"><i class="fa fa-code fa-fw" aria-hidden="true"></i> CCF NOI</a></li></ul></div></section><section class="widget category widget-blur desktop"><header><a href="/categories/"><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i><span class="name">文章分类</span></a></header><div class="content"><ul class="entry navigation"><li><a class="flat-box" title="/categories/%E5%8D%B3%E6%97%B6%E7%AC%94%E8%AE%B0/" href="/categories/%E5%8D%B3%E6%97%B6%E7%AC%94%E8%AE%B0/" id="categoriesE58DB3E697B6E7AC94E8AEB0"><div class="name">即时笔记</div><div class="badge">(5)</div></a></li><li><a class="flat-box" title="/categories/%E6%80%BB%E7%BB%93/" href="/categories/%E6%80%BB%E7%BB%93/" id="categoriesE680BBE7BB93"><div class="name">总结</div><div class="badge">(1)</div></a></li><li><a class="flat-box" title="/categories/%E7%A9%BF%E9%80%8F%E4%B8%96%E7%95%8C%E8%BE%B9%E7%BC%98%E7%9A%84%E5%91%90%E5%96%8A/" href="/categories/%E7%A9%BF%E9%80%8F%E4%B8%96%E7%95%8C%E8%BE%B9%E7%BC%98%E7%9A%84%E5%91%90%E5%96%8A/" id="categoriesE7A9BFE9808FE4B896E7958CE8BEB9E7BC98E79A84E59190E5968A"><div class="name">穿透世界边缘的呐喊</div><div class="badge">(2)</div></a></li><li><a class="flat-box" title="/categories/%E9%9A%8F%E7%AC%94/" href="/categories/%E9%9A%8F%E7%AC%94/" id="categoriesE99A8FE7AC94"><div class="name">随笔</div><div class="badge">(3)</div></a></li></ul></div></section><section class="widget tagcloud widget-blur desktop"><header><a href="/tags/"><i class="fas fa-tags fa-fw" aria-hidden="true"></i><span class="name">热门标签</span></a></header><div class="content"><a href="/tags/THUWC/" style="font-size:14px;color:#999">THUWC</a> <a href="/tags/%E4%B8%96%E7%95%8C%E9%97%B4%E7%BB%AA%E8%AE%BA/" style="font-size:14px;color:#999">世界间绪论</a> <a href="/tags/%E4%B8%96%E7%95%8C%E9%97%B4%E8%AF%84%E8%AE%BA/" style="font-size:14px;color:#999">世界间评论</a> <a href="/tags/%E4%BD%A0%E7%9A%84%E5%90%8D%E5%AD%97/" style="font-size:14px;color:#999">你的名字</a> <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" style="font-size:14px;color:#999">动态规划</a> <a href="/tags/%E5%9B%BE%E8%AE%BA/" style="font-size:14px;color:#999">图论</a> <a href="/tags/%E5%A5%87%E9%97%BB/" style="font-size:14px;color:#999">奇闻</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size:14px;color:#999">字符串</a> <a href="/tags/%E6%90%9C%E7%B4%A2/" style="font-size:14px;color:#999">搜索</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size:14px;color:#999">数学</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size:14px;color:#999">数据结构</a> <a href="/tags/%E6%A0%91/" style="font-size:14px;color:#999">树</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size:24px;color:#555">笔记</a> <a href="/tags/%E8%92%9F%E8%92%BB/" style="font-size:14px;color:#999">蒟蒻</a> <a href="/tags/%E8%B4%AA%E5%BF%83/" style="font-size:14px;color:#999">贪心</a> <a href="/tags/%E9%80%80%E5%BD%B9/" style="font-size:14px;color:#999">退役</a></div></section><section class="widget toc-wrapper widget-blur desktop mobile"><header><i class="fas fa-list fa-fw" aria-hidden="true"></i><span class="name">本文目录</span></header><div class="content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#数学"><span class="toc-text">数学</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#gcd"><span class="toc-text">$\gcd$</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#定义与证明"><span class="toc-text">定义与证明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CQOI-2014-数三角形"><span class="toc-text">CQOI 2014 数三角形</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mathrm-exgcd"><span class="toc-text">$\mathrm{exgcd}$</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#算法证明"><span class="toc-text">算法证明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#青蛙的约会"><span class="toc-text">青蛙的约会</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#小凯的遗憾-疑惑"><span class="toc-text">小凯的遗憾 疑惑</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#快速幂-mathrm-kasumi-与费马-欧拉定理"><span class="toc-text">快速幂 ($\mathrm{kasumi}$) 与费马-欧拉定理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#费马小定理"><span class="toc-text">费马小定理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#逆元"><span class="toc-text">逆元</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#计算系数-组合数问题"><span class="toc-text">计算系数 组合数问题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#中国剩余定理"><span class="toc-text">中国剩余定理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#各种筛"><span class="toc-text">各种筛</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Violet-5-樱花"><span class="toc-text">Violet 5 樱花</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#高精度"><span class="toc-text">高精度</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#LLH邀请赛-大数计算器"><span class="toc-text">LLH邀请赛 大数计算器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#解方程"><span class="toc-text">解方程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#容斥原理（经典型）"><span class="toc-text">容斥原理（经典型）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Cirno-的完美算数教室"><span class="toc-text">Cirno 的完美算数教室</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HAOI-2008-硬币购物"><span class="toc-text">HAOI 2008 硬币购物</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#博弈论"><span class="toc-text">博弈论</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#取石子游戏-1-——理解必胜和必败态"><span class="toc-text">取石子游戏 1 ——理解必胜和必败态</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#取石子游戏-2-——组合游戏和-SG-函数"><span class="toc-text">取石子游戏 2 ——组合游戏和 SG 函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#取石子游戏-3-——游戏-1-和游戏-2-的结合"><span class="toc-text">取石子游戏 3 ——游戏 1 和游戏 2 的结合</span></a></li></ol></li></ol></li></ol></div></section></aside><footer class="clearfix"><br><br><div class="aplayer-container"><meting-js theme="#1BCDFC" autoplay volume="0.7" loop order="list" fixed="false" list-max-height="340px" server="netease" type="song" id="551339691" list-folded="true"></meting-js></div><br><div class="social-wrapper"><a href="mailto:mrj1018@163.com" class="social fas fa-envelope flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a> <a href="https://github.com/mrj1018" class="social fab fa-github flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a> <a href="https://www.luogu.com.cn/user/25008" class="social fas fa-code flat-btn" target="_blank" rel="external nofollow noopener noreferrer"></a></div><div class="copyright"><p><a href="https://sweetlemon39.github.io">By Sweetlemon</a></p></div></footer><script>setLoadingBarProgress(80)</script><script>setLoadingBarProgress(60)</script></div><a class="s-top fas fa-arrow-up fa-fw" href="javascript:void(0)"></a></div><script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script><script>var SEARCH_SERVICE="hexo",ROOT="/";ROOT.endsWith("/")||(ROOT+="/")</script><script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@1.7.1/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script><script async src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script><script async src="https://cdn.jsdelivr.net/npm/meting@2.0/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js" async></script><script type="text/javascript">$(function(){Waves.attach(".flat-btn",["waves-button"]),Waves.attach(".float-btn",["waves-button","waves-float"]),Waves.attach(".float-btn-light",["waves-button","waves-float","waves-light"]),Waves.attach(".flat-box",["waves-block"]),Waves.attach(".float-box",["waves-block","waves-float"]),Waves.attach(".waves-image"),Waves.init()})</script><script src="//cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script><script type="text/javascript">$(function(){var e=["https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/vc_247324.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/violet_259998.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/sukasuka__07.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/sukasuka__06.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/sukasuka__03.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/your_name_233767.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/sukasuka__05.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/kagerou_183538.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/miku_262935.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/sukasuka__01.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/tianyi_221481.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/miku_289028.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/kagerou_184531.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/ia_292142.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/vc_184412.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/tianyi_229042.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/sukasuka__02.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/miku_288524.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/sukasuka__04.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/anohana_172855.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/miku_279631.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/sukasuka__08.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/kagerou_191672.jpg","https://cdn.jsdelivr.net/gh/Sweetlemon39/Sweetlemon39.github.io@dev/images/bg/violet_261791.jpg"];!function(e){for(var t=e.length;t--;){var g=Math.floor(Math.random()*t),i=e[g];e[g]=e[t],e[t]=i}}(e),$.backstretch(e,{duration:"20000",fade:"2500"})})</script><script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@1.7.1/js/valine.js"></script><script>var GUEST_INFO=["nick","mail","link"],guest_info="nick,mail,link".split(",").filter(function(i){return-1<GUEST_INFO.indexOf(i)}),notify=!1,verify=!1,valine=new Valine;valine.init({el:"#valine_container",notify:notify,verify:verify,guest_info:guest_info,appId:"uzT4lXHwcPJOlEGevXF7jqRU-gzGzoHsz",appKey:"vVl1bqbOX0WUiA9WFlFhMxBb",placeholder:"快来评论吧~",pageSize:"10",avatar:"mp",lang:"zh-cn",visitor:"false",highlight:"true"})</script><script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@1.7.1/js/app.js"></script><script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@1.7.1/js/search.js"></script><script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@1.7.1/js/comment_typing.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script><script>let COPY_SUCCESS = "复制成功";
  let COPY_FAILURE = "复制失败";
  /*页面载入完成后，创建复制按钮*/
  !function (e, t, a) {
    /* code */
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '  <i class="fa fa-copy"></i><span>复制</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });

      clipboard.on('success', function(e) {
        //您可以加入成功提示
        console.info('Action:', e.action);
        console.info('Text:', e.text);
        console.info('Trigger:', e.trigger);
        success_prompt(COPY_SUCCESS);
        e.clearSelection();
      });
      clipboard.on('error', function(e) {
        //您可以加入失败提示
        console.error('Action:', e.action);
        console.error('Trigger:', e.trigger);
        fail_prompt(COPY_FAILURE);
      });
    }
    initCopyCode();

  }(window, document);

  /**
   * 弹出式提示框，默认1.5秒自动消失
   * @param message 提示信息
   * @param style 提示样式，有alert-success、alert-danger、alert-warning、alert-info
   * @param time 消失时间
   */
  var prompt = function (message, style, time)
  {
      style = (style === undefined) ? 'alert-success' : style;
      time = (time === undefined) ? 1500 : time*1000;
      $('<div>')
          .appendTo('body')
          .addClass('alert ' + style)
          .html(message)
          .show()
          .delay(time)
          .fadeOut();
  };

  // 成功提示
  var success_prompt = function(message, time)
  {
      prompt(message, 'alert-success', time);
  };

  // 失败提示
  var fail_prompt = function(message, time)
  {
      prompt(message, 'alert-danger', time);
  };

  // 提醒
  var warning_prompt = function(message, time)
  {
      prompt(message, 'alert-warning', time);
  };

  // 信息提示
  var info_prompt = function(message, time)
  {
      prompt(message, 'alert-info', time);
  };</script><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script>let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });</script><script>setLoadingBarProgress(100)</script></body></html>